-- Make blank fields (non-null) fields null

    update "<orig_table>" set acreage    = null where acreage    like '';
    update "<orig_table>" set lotdepthft = null where lotdepthft like '';
    update "<orig_table>" set lotfrontft = null where lotfrontft like '';

-- create _v2 table copying table structure of original table

    create table "<out_table>" (like "<orig_table>" including all);

-- modify implied decimal text fields of _v2 table to FLOAT

    alter table "<out_table>" 
		alter column acreage    type float4 using    acreage::numeric(30, 3), 
		alter column lotdepthft type float4 using lotdepthft::numeric(30, 1),
		alter column lotsizesft type float4 using lotsizesft::numeric(30, 1), 
		alter column lotfrontft type float4 using lotfrontft::numeric(30, 1), 
		alter column blgnumbath type float4 using blgnumbath::numeric(6, 2);

-- copy rows from original table to _v2 TABLE

	insert into "<out_table>" 
	(
		fips,
		state,
		postal,
		county,
		pointloc,
		parcelapn,
		taxapn,
		dupapn,
		altoldapni,
		oldapn,
		propsrcflg,
		propfuladd,
		prophsnum,
		propstdirl,
		propstname,
		propstsuff,
		propstdirr,
		propunttyp,
		propuntnum,
		propcity,
		propstate,
		propzip,
		propzip4,
		propcentct,
		proplat,
		proplong,
		datum,
		proplat27,
		proplong27,
		gsmtchcode,
		gsloccode,
		owner1ind,
		owner1typ,
		owner1,
		owner2ind,
		owner2typ,
		owner2,
		mailcrofin,
		careofname,
		ownsrccode,
		ownvestcd,
		taxacctnum,
		mailfuladd,
		mailunttyp,
		mailuntnum,
		mailcity,
		mailstate,
		mailzip,
		mailzip4,
		curownname,
		curownaddr,
		curowncity,
		curownst,
		curownzip,
		curownzip4,
		curownutyp,
		curownunum,
		landusecod,
		landusedes,
		ownoccures,
		zoning,
		landval,
		improvval,
		totalvalue,
		mktvalland,
		mktimprval,
		mkttotval,
		mktvalyear,
		recrdocnum,
		recrdbknum,
		recrdpgnum,
		doctypecty,
		salesprice,
		salescode,
		ctycrtdat,
		latsaldate,
		latsalprc,
		latslprccd,
		latsalbook,
		latsalpage,
		latsaldocn,
		latsaldoct,
		latvalrecd,
		latvalprce,
		latvalprcd,
		latvalbook,
		latvalpage,
		latvaldocn,
		latvaldtyp,
		prevsaledt,
		prevsalepr,
		prevsalecd,
		prevsaledn,
		prevsaldtc,
		prevsalbkn,
		prevsalpgn,
		prvvalrdat,
		prvvalpric,
		prvvalpcod,
		prvvalbook,
		prvvalpage,
		prvvaldocn,
		prvvaldoct,
		asssrcfld,
		assessyear,
		cahomexemp,
		taxexemcod,
		taxcodarea,
		taxsource,
		taxamount,
		taxyear,
		taxdelyear,
		medtwprng,
		meridian,
		township,
		twpdir,
		range,
		rangedir,
		section,
		nyciviltwp,
		pamuninumb,
		pamuniname,
		wvdistnumb,
		wvdistname,
		legaldesc,
		lgldesfull,
		lgllotcode,
		lgllotnum,
		lgllandlot,
		legalblock,
		legalsec,
		legaldist,
		legalunit,
		lglctytpmu,
		lglsubdnam,
		lglphasnum,
		lgltrctnum,
		lglmtrs,
		lglmapref,
		lotarea,
		lotareaunt,
		acreage,
		lotsizesft,
		lotfrontft,
		lotdepthft,
		origlotsiz,
		topography,
		mortlendnm,
		siteinfuen,
		amenities1,
		amenities2,
		cndoprjnam,
		water,
		sewer,
		blgarea,
		blgmainind,
		blgclass,
		blgcondn,
		blgyearblt,
		blgefyrblt,
		blgquality,
		blgnumplum,
		blgflcover,
		blgstrynum,
		blgrmtotal,
		blgnumunit,
		blgnumbed,
		blgnumbath,
		blgnumpbth,
		blggrgtype,
		blggrgcrnm,
		blgpool,
		blgstyle,
		blgcnstype,
		blgextwall,
		blgintwall,
		blgfoundn,
		blgroofcvr,
		blgrooftyp,
		blgheating,
		blghtfltyp,
		blgaircond,
		blgactype,
		blgelevatr,
		blgfireplc,
		blgbasemnt,
		blgnumber,
		blgarea1,
		blgareain1,
		blgarea2,
		blgareain2,
		blgarea3,
		blgareain3,
		blgarea4,
		blgareain4,
		blgarea5,
		blgareain5,
		blgarea6,
		blgareain6,
		blgarea7,
		blgareain7,
		othimpblg1,
		othimpb1in,
		othimpblg2,
		othimpb2in,
		othimpblg3,
		othimpb3in,
		othimpblg4,
		othimpb4in,
		othimpblg5,
		othimpb5in,
		xtrfeat1,
		xtrfeat1in,
		xtrfeat2,
		xtrfeat2in,
		xtrfeat3,
		xtrfeat3in,
		xtrfeat4,
		xtrfeat4in,
		schtaxdis1,
		schtax1ind,
		schtaxdis2,
		schtax2ind,
		schtaxdis3,
		schtax3ind,
		neighcode,
		rawprpfull,
		rawprphsnm,
		rawprpalph,
		rawprpdirl,
		rawprpstnm,
		rawprpstsx,
		rawprpdirr,
		rawprpunnm,
		rawprpcity,
		rawprpstat,
		rawprpzip,
		rawprpzip4,
		rawmlfull,
		rawmlhsnm,
		rawmlalpha,
		rawmldirl,
		rawmlstnm,
		rawmlstsx,
		rawmldirr,
		rawmlunnm,
		rawmlcity,
		rawmlstate,
		rawmlzip,
		rawmlzip4,
		edition,
		own1first,
		own1middle,
		own1last,
		own2first,
		own2middle,
		own2last,
		comments,
		source,
		amoddate,
		gmoddate,
		geom"
	)
	select 
		fips,
		state,
		postal,
		county,
		pointloc,
		parcelapn,
		taxapn,
		dupapn,
		altoldapni,
		oldapn,
		propsrcflg,
		propfuladd,
		prophsnum,
		propstdirl,
		propstname,
		propstsuff,
		propstdirr,
		propunttyp,
		propuntnum,
		propcity,
		propstate,
		propzip,
		propzip4,
		propcentct,
		proplat,
		proplong,
		datum,
		proplat27,
		proplong27,
		gsmtchcode,
		gsloccode,
		owner1ind,
		owner1typ,
		owner1,
		owner2ind,
		owner2typ,
		owner2,
		mailcrofin,
		careofname,
		ownsrccode,
		ownvestcd,
		taxacctnum,
		mailfuladd,
		mailunttyp,
		mailuntnum,
		mailcity,
		mailstate,
		mailzip,
		mailzip4,
		curownname,
		curownaddr,
		curowncity,
		curownst,
		curownzip,
		curownzip4,
		curownutyp,
		curownunum,
		landusecod,
		landusedes,
		ownoccures,
		zoning,
		landval,
		improvval,
		totalvalue,
		mktvalland,
		mktimprval,
		mkttotval,
		mktvalyear,
		recrdocnum,
		recrdbknum,
		recrdpgnum,
		doctypecty,
		salesprice,
		salescode,
		ctycrtdat,
		latsaldate,
		latsalprc,
		latslprccd,
		latsalbook,
		latsalpage,
		latsaldocn,
		latsaldoct,
		latvalrecd,
		latvalprce,
		latvalprcd,
		latvalbook,
		latvalpage,
		latvaldocn,
		latvaldtyp,
		prevsaledt,
		prevsalepr,
		prevsalecd,
		prevsaledn,
		prevsaldtc,
		prevsalbkn,
		prevsalpgn,
		prvvalrdat,
		prvvalpric,
		prvvalpcod,
		prvvalbook,
		prvvalpage,
		prvvaldocn,
		prvvaldoct,
		asssrcfld,
		assessyear,
		cahomexemp,
		taxexemcod,
		taxcodarea,
		taxsource,
		taxamount,
		taxyear,
		taxdelyear,
		medtwprng,
		meridian,
		township,
		twpdir,
		range,
		rangedir,
		section,
		nyciviltwp,
		pamuninumb,
		pamuniname,
		wvdistnumb,
		wvdistname,
		legaldesc,
		lgldesfull,
		lgllotcode,
		lgllotnum,
		lgllandlot,
		legalblock,
		legalsec,
		legaldist,
		legalunit,
		lglctytpmu,
		lglsubdnam,
		lglphasnum,
		lgltrctnum,
		lglmtrs,
		lglmapref,
		lotarea,
		lotareaunt,
		acreage::DOUBLE PRECISION,
		lotsizesft::DOUBLE PRECISION,
		lotfrontft::DOUBLE PRECISION,
		lotdepthft::DOUBLE PRECISION,
		origlotsiz,
		topography,
		mortlendnm,
		siteinfuen,
		amenities1,
		amenities2,
		cndoprjnam,
		water,
		sewer,
		blgarea,
		blgmainind,
		blgclass,
		blgcondn,
		blgyearblt,
		blgefyrblt,
		blgquality,
		blgnumplum,
		blgflcover,
		blgstrynum,
		blgrmtotal,
		blgnumunit,
		blgnumbed,
		blgnumbath::DOUBLE PRECISION,
		blgnumpbth,
		blggrgtype,
		blggrgcrnm,
		blgpool,
		blgstyle,
		blgcnstype,
		blgextwall,
		blgintwall,
		blgfoundn,
		blgroofcvr,
		blgrooftyp,
		blgheating,
		blghtfltyp,
		blgaircond,
		blgactype,
		blgelevatr,
		blgfireplc,
		blgbasemnt,
		blgnumber,
		blgarea1,
		blgareain1,
		blgarea2,
		blgareain2,
		blgarea3,
		blgareain3,
		blgarea4,
		blgareain4,
		blgarea5,
		blgareain5,
		blgarea6,
		blgareain6,
		blgarea7,
		blgareain7,
		othimpblg1,
		othimpb1in,
		othimpblg2,
		othimpb2in,
		othimpblg3,
		othimpb3in,
		othimpblg4,
		othimpb4in,
		othimpblg5,
		othimpb5in,
		xtrfeat1,
		xtrfeat1in,
		xtrfeat2,
		xtrfeat2in,
		xtrfeat3,
		xtrfeat3in,
		xtrfeat4,
		xtrfeat4in,
		schtaxdis1,
		schtax1ind,
		schtaxdis2,
		schtax2ind,
		schtaxdis3,
		schtax3ind,
		neighcode,
		rawprpfull,
		rawprphsnm,
		rawprpalph,
		rawprpdirl,
		rawprpstnm,
		rawprpstsx,
		rawprpdirr,
		rawprpunnm,
		rawprpcity,
		rawprpstat,
		rawprpzip,
		rawprpzip4,
		rawmlfull,
		rawmlhsnm,
		rawmlalpha,
		rawmldirl,
		rawmlstnm,
		rawmlstsx,
		rawmldirr,
		rawmlunnm,
		rawmlcity,
		rawmlstate,
		rawmlzip,
		rawmlzip4,
		edition,
		own1first,
		own1middle,
		own1last,
		own2first,
		own2middle,
		own2last,
		comments,
		source,
		amoddate,
		gmoddate,
		geom"
	from
	"<orig_table>";

-- Perform calculations on fields converted to float above

	update "<out_table>"  set lotdepthft = lotdepthft/10;
	update "<out_table>"  set lotfrontft = lotfrontft/10;
	update "<out_table>"  set blgnumbath = blgnumbath/100;
	update "<out_table>"  set acreage = round((lotsizesft::numeric/43560),3);

-- final vacuum
  
	vacuum analyze "<out_table>";
